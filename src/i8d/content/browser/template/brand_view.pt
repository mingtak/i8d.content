<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
    xmlns:tal="http://xml.zope.org/namespaces/tal"
    xmlns:metal="http://xml.zope.org/namespaces/metal"
    xmlns:i18n="http://xml.zope.org/namespaces/i18n"
    lang="en"
    metal:use-macro="context/main_template/macros/master"
    i18n:domain="i8d.content">
<body>


<metal:content-core fill-slot="content-core">
<metal:content-core define-macro="content-core"
                    tal:define="toc context/table_of_contents|nothing;">

<?python
from plone import api
portal = api.portal.get()

if api.user.is_anonymous():
    manageBrand = False
else:
    roles = api.user.get_roles()
    manageBrand = 'Manager' in roles
?>

<!--
<tal:check_roles condition="manageBrand">
  <p><strong>品牌別名：</strong><span tal:replace="context/nickname"/></p>
  <img tal:replace="structure context/@@images/image/mini | nothing" />
  <img tal:replace="structure context/@@images/bannerImage/preview | nothing"/><br/>
</tal:check_roles>
-->

<!--
<tal:check_roles condition="not:manageBrand">
-->
  <section class="main-container col2-left-layout"
           tal:define="sortBy python:getattr(request, 'sortBy', 'ProductName');
                       sortBy python:'sortable_title' if sortBy == 'ProductName' else 'salePrice'">
    <tal:brain define="catalog python:context.portal_catalog;
                       brain python:catalog({'brand':context.nickname.encode('utf-8').split(','),
                                             'Type':'Product'}, sort_on=sortBy)">

      <metal:macro use-macro="context/@@i8d_macro/macros/productList" />

    </tal:brain>
  </section>

<!-- </tal:check_roles> -->

</metal:content-core>
</metal:content-core>

</body>
</html>
